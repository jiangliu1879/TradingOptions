# SPY股价分析预测系统

这是一个基于Streamlit的SPY股价分析预测系统，集成了多种预测算法和技术分析工具。

## 功能特性

### 📊 数据分析页面
- **主页**: SPY历史数据概览和基础图表
- **涨跌幅统计**: 股价涨跌幅的统计分析
- **马尔可夫链预测**: 使用马尔可夫链模型预测股价
- **卡尔曼滤波预测**: 使用卡尔曼滤波算法预测股价
- **RNN预测**: 使用循环神经网络预测股价

### 🧠 预测算法
1. **马尔可夫链**: 基于状态转移的概率预测
2. **卡尔曼滤波**: 递归状态估计算法，适合处理噪声数据
3. **RNN/LSTM**: 深度学习模型，能捕捉长期时间序列依赖
4. **隐马尔可夫模型**: 识别隐藏市场状态，基于状态转移预测

### 📈 技术指标
- 移动平均线 (MA5, MA20)
- 日收益率
- 波动率
- 成交量分析

## 安装和使用

### 1. 环境要求
- Python 3.8+
- 足够的磁盘空间存储数据

### 2. 安装依赖
```bash
pip install -r requirements.txt
```

### 3. 获取数据
首先运行数据获取脚本：
```bash
python utils/longport_get_data.py
```

### 4. 启动应用
```bash
streamlit run home.py
```

### 5. 模型管理（可选）
```bash
# 列出所有保存的模型
python model_manager.py --action list

# 查看模型详细信息
python model_manager.py --action info --model PyTorch_LSTM_20231201_143022.pth

# 删除模型文件
python model_manager.py --action delete --model PyTorch_LSTM_20231201_143022.pth
```

## 页面说明

### 🏠 主页 (home.py)
- SPY历史数据概览
- 交互式价格走势图
- 基础统计信息

### 📊 涨跌幅统计 (pages/1_涨跌幅统计.py)
- 日涨跌幅分布
- 累计收益率分析
- 波动性分析

### 🔄 马尔可夫链预测 (pages/2_股价预测-马尔可夫链.py)
- 状态转移矩阵分析
- 概率预测
- 趋势预测

### 📈 卡尔曼滤波预测 (pages/3_股价预测-卡尔曼滤波.py)
- 噪声过滤
- 状态估计
- 未来预测（排除周末）

### 🧠 RNN预测 (pages/4_股价预测-RNN.py)
- SimpleRNN和LSTM模型
- 深度学习预测
- 模型训练和评估
- 未来预测（排除周末）

### 🔥 PyTorch RNN预测 (pages/5_股价预测-PyTorch_RNN.py)
- PyTorch实现的RNN/LSTM/GRU模型
- 自定义模型架构
- GPU加速支持
- 更灵活的模型控制
- 模型保存和加载
- 自动保存到项目根目录
- 模型管理工具

### 🎭 隐马尔可夫模型预测 (pages/6_股价预测-隐马尔可夫模型.py)
- 隐藏状态识别
- 状态转移矩阵分析
- 状态持续时间分析
- 基于状态的预测
- 多特征HMM模型
- 状态特征可视化

### 🐍 Python HMM实现 (pages/5_股价预测-隐马尔可夫模型(python实现).py)
- 纯Python实现的HMM算法
- 前向-后向算法
- 维特比算法
- Baum-Welch算法
- 高斯混合模型
- 完全自主实现，无外部依赖

## 使用建议

### 数据选择
- 建议使用至少1年的历史数据
- 数据量越大，模型效果越好

### 参数调优
- **序列长度**: RNN模型建议60-120个交易日
- **隐藏层单元**: 根据数据复杂度调整（20-200）
- **Dropout率**: 防止过拟合（0.1-0.5）

### 预测注意事项
- 所有预测都自动排除周末
- 短期预测（1-3天）准确度较高
- 长期预测仅供参考
- 建议结合多个模型结果

## 技术架构

### 前端
- **Streamlit**: Web应用框架
- **Plotly**: 交互式图表
- **Pandas**: 数据处理

### 后端
- **NumPy**: 数值计算
- **Scikit-learn**: 机器学习工具
- **TensorFlow**: 深度学习框架
- **PyTorch**: 深度学习框架（更灵活的模型控制）
- **HMMLearn**: 隐马尔可夫模型库

### 数据存储
- CSV格式存储历史数据
- 支持增量数据更新
- PyTorch模型文件(.pth)保存到根目录

## 免责声明

⚠️ **重要提醒**:
- 本系统仅用于技术分析和学习目的
- 预测结果不构成投资建议
- 股市存在不确定性，实际价格可能与预测存在较大偏差
- 投资有风险，请谨慎决策，建议咨询专业投资顾问

## 更新日志

### v1.0.0
- 基础数据分析功能
- 马尔可夫链预测
- 卡尔曼滤波预测
- RNN/LSTM深度学习预测
- PyTorch RNN/LSTM/GRU预测
- 隐马尔可夫模型预测
- Python HMM算法实现
- 自动排除周末预测
- 交互式参数调整
- GPU加速支持
- 模型自动保存到根目录
- 模型管理工具

## 贡献

欢迎提交Issue和Pull Request来改进这个项目！

## 许可证

MIT License 